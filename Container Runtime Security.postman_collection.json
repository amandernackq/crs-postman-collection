{
	"info": {
		"_postman_id": "213ae9da-491d-43cb-b128-4b94b3da0c5c",
		"name": "Container Runtime Security",
		"description": "Some API Calls, including policy upload",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Upload a Network Policy - Block httpd port 80",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\"Name\": \"Block_httpd\",\n    \"SchemaVersion\": \"v1.0\",\n    \"DefaultNetworkAction\": \"allow\",\n    \"DefaultProgramAction\": \"allow\",\n    \"DefaultFileAction\": \"allow\",\n    \"Rules\": [\n        {\n            \"Name\": \"Block port 80\",\n             \"RuleType\": \"listener\",\n             \"ListeningPort\": 80,\n             \"Action\": \"deny\",\n             \"ListeningAddr\": \"*\"\n        }\n    ],\n    \"IgnoredSyscalls\": [],\n    \"Limits\": {\n        \"MaxNumProc\": 0,\n        \"MaxProcLife\": 0,\n        \"Syscalls\": [],\n        \"Processes\": []\n    },\n    \"Mode\": 0,\n    \"Behavioral\": true,\n    \"Description\": \"Block Access to HTTPD Port 80\"\n}"
				},
				"url": {
					"raw": "https://{{base_url}}/crs/v1.2/api/Policies/",
					"protocol": "https",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"crs",
						"v1.2",
						"api",
						"Policies",
						""
					]
				},
				"description": "Upload a policy to block access to HTTPD port 80"
			},
			"response": []
		},
		{
			"name": "List all policies",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "https://{{base_url}}/crs/v1.2/api/Policies/",
					"protocol": "https",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"crs",
						"v1.2",
						"api",
						"Policies",
						""
					]
				}
			},
			"response": []
		},
		{
			"name": "List details of a policy",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "https://{{base_url}}/crs/v1.2/api/Policies/<REPLACE_THIS_WITH_THE_POLICY_ID_FROM_QUALYS_UI_URL>",
					"protocol": "https",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"crs",
						"v1.2",
						"api",
						"Policies",
						"<REPLACE_THIS_WITH_THE_POLICY_ID_FROM_QUALYS_UI_URL>"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Auth Token",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/x-www-form-urlencoded",
						"type": "text"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "username",
							"value": "{{username}}",
							"type": "text"
						},
						{
							"key": "password",
							"value": "{{password}}",
							"type": "text"
						},
						{
							"key": "token",
							"value": "true",
							"type": "text"
						},
						{
							"key": "permissions",
							"value": "true",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "https://{{base_url}}/auth",
					"protocol": "https",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"auth"
					]
				},
				"description": "Your token will appear in the Body section of the response, which should be 201 Created"
			},
			"response": []
		},
		{
			"name": "Delete a Policy",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "DELETE",
				"header": [],
				"url": {
					"raw": "https://{{base_url}}/crs/v1.2/api/Policies/<REPLACE_THIS_WITH_THE_POLICY_ID_FROM_QUALYS_UI_URL>",
					"protocol": "https",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"crs",
						"v1.2",
						"api",
						"Policies",
						"<REPLACE_THIS_WITH_THE_POLICY_ID_FROM_QUALYS_UI_URL>"
					]
				},
				"description": "This request removes an existing policy, whose ID should be set in the variable {{policy_ref}}"
			},
			"response": []
		},
		{
			"name": "Upload a Network Policy - Block SSHD from ANY",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\"Name\": \"Block_sshd\",\n    \"SchemaVersion\": \"v1.0\",\n    \"DefaultNetworkAction\": \"allow\",\n    \"DefaultProgramAction\": \"allow\",\n    \"DefaultFileAction\": \"allow\",\n    \"Rules\": [\n        {\n            \"Name\": \"Block port 22\",\n             \"RuleType\": \"listener\",\n             \"ListeningPort\": 22,\n             \"Action\": \"deny\",\n             \"ListeningAddr\": \"*\"\n        }\n    ],\n    \"IgnoredSyscalls\": [],\n    \"Limits\": {\n        \"MaxNumProc\": 0,\n        \"MaxProcLife\": 0,\n        \"Syscalls\": [],\n        \"Processes\": []\n    },\n    \"Mode\": 0,\n    \"Behavioral\": false,\n    \"Description\": \"Block Any IP Address to SSHD\"\n\n}"
				},
				"url": {
					"raw": "https://{{base_url}}/crs/v1.2/api/Policies/",
					"protocol": "https",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"crs",
						"v1.2",
						"api",
						"Policies",
						""
					]
				},
				"description": "Block any IP Address to SSHD"
			},
			"response": []
		},
		{
			"name": "Upload an Application Policy - deny cat access to passwd",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\"Name\": \"Deny access\",\n    \"SchemaVersion\": \"v1.0\",\n    \"DefaultNetworkAction\": \"allow\",\n    \"DefaultProgramAction\": \"allow\",\n    \"DefaultFileAction\": \"allow\",\n    \"Rules\": [\n        {\n            \"Name\": \"Deny passwd\",\n            \"InActive\": false,\n            \"RuleType\": \"syscall\",\n            \"Program\": \"/bin/cat\",\n            \"Action\": \"deny\",\n            \"File\": \"\",\n            \"Syscall\": \"sys_open\",\n            \"Arg1\": \"/etc/passwd\",\n            \"Arg2\": \"\",\n            \"Arg3\": \"\"\n        }\n    ],\n    \"IgnoredSyscalls\": [],\n    \"Limits\": {\n        \"MaxNumProc\": 0,\n        \"MaxProcLife\": 0,\n        \"Syscalls\": [],\n        \"Processes\": []\n    },\n    \"Mode\": 0,\n    \"Behavioral\": true,\n    \"Description\": \"Deny access with cat to /etc/passwd with Log\"\n}"
				},
				"url": {
					"raw": "https://{{base_url}}/crs/v1.2/api/Policies/",
					"protocol": "https",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"crs",
						"v1.2",
						"api",
						"Policies",
						""
					]
				},
				"description": "This policy denies access for \"cat\" executable to the file /etc/passwd.\nIf you try with \"more\" or \"less\" commands it works.\nIt also logs the behavior to the UI."
			},
			"response": []
		},
		{
			"name": "Upload a File Policy - Block cat access to shadow",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\"Name\":\"No Access to Shadow from cat\",\n   \"SchemaVersion\":\"v1.0\",\n   \"DefaultNetworkAction\":\"\",\n   \"DefaultProgramAction\":\"\",\n   \"DefaultFileAction\":\"\",\n   \"Rules\":[ \n      { \n         \"Name\":\"shadow_access_deny_rule\",\n         \"DateCreated\":\"2019-11-05T00:00:00Z\",\n         \"DateUpdated\":\"2019-11-05T00:00:00Z\",\n         \"InActive\":false,\n         \"RuleType\":\"File\",\n         \"Program\":\"/bin/cat\",\n         \"Action\":\"deny\",\n         \"File\":\"/etc/shadow\",\n         \"Syscall\":\"\"\n      }\n   ],\n   \"IgnoredSyscalls\":[ \n\n   ],\n   \"Limits\":{ \n      \"MaxNumProc\":0,\n      \"MaxProcLife\":0,\n      \"Syscalls\":[ \n\n      ],\n      \"Processes\":[ \n\n      ]\n   },\n   \"Mode\":0,\n   \"Behavioral\":false,\n   \"Description\":\"Monitor the Write event for mentioned bash files\"\n}"
				},
				"url": {
					"raw": "https://{{base_url}}/crs/v1.2/api/Policies/",
					"protocol": "https",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"crs",
						"v1.2",
						"api",
						"Policies",
						""
					]
				},
				"description": "This policy blocks the program \"cat\" access to the file \"/etc/shadow\""
			},
			"response": []
		}
	],
	"protocolProfileBehavior": {}
}